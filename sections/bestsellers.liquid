{% comment %}
  Enhanced Bestsellers section for N√ºHome theme
  Features: Eye-catching winter-themed product showcase with social proof and urgency
{% endcomment %}

{%- liquid
  assign collection = collections[section.settings.collection]
  assign products_to_show = section.settings.products_to_show
  assign columns_desktop = section.settings.columns_desktop
-%}

<section
  class="bestsellers"
  data-section-id="{{ section.id }}"
  data-section-type="bestsellers">
  <!-- Background Decorations -->
  <div class="bestsellers__background">
    <div class="bestsellers__snowflakes">
      <div class="bestsellers__snowflake">‚ùÑÔ∏è</div>
      <div class="bestsellers__snowflake">‚ú®</div>
      <div class="bestsellers__snowflake">‚ùÑÔ∏è</div>
      <div class="bestsellers__snowflake">‚ú®</div>
      <div class="bestsellers__snowflake">‚ùÑÔ∏è</div>
    </div>
  </div>

  <div class="container">
    <!-- Header Section -->
    <div class="bestsellers__header text-center">
      {% if section.settings.heading != blank %}
        <div class="bestsellers__title-wrapper">
          <span class="bestsellers__title-badge">üî• Trending Now</span>
          <h2 class="bestsellers__title">
            <span class="bestsellers__title-text">{{ section.settings.heading }}</span>
            <span class="bestsellers__title-decoration">‚ùÑÔ∏è‚ú®‚ùÑÔ∏è</span>
          </h2>
        </div>
      {% endif %}

      {% if section.settings.subheading != blank %}
        <p class="bestsellers__subtitle">{{ section.settings.subheading }}</p>
      {% endif %}

      <!-- Social Proof Stats -->
      <div class="bestsellers__stats">
        <div class="bestsellers__stat">
          <div class="bestsellers__stat-number">{{ collection.all_products_count | default: 15 }}+</div>
          <div class="bestsellers__stat-label">Premium Products</div>
        </div>
        <div class="bestsellers__stat">
          <div class="bestsellers__stat-number">50K+</div>
          <div class="bestsellers__stat-label">Happy Customers</div>
        </div>
        <div class="bestsellers__stat">
          <div class="bestsellers__stat-number">4.8‚òÖ</div>
          <div class="bestsellers__stat-label">Average Rating</div>
        </div>
      </div>
    </div>

    {% if collection != blank and collection.products.size > 0 %}
      <!-- Products Grid -->
      <div class="bestsellers__grid-wrapper">
        <div class="bestsellers__grid grid grid-{{ columns_desktop }}">
          {% for product in collection.products limit: products_to_show %}
            <div class="bestsellers__item" style="animation-delay: {{ forloop.index0 | times: 0.1 }}s;">
              {% render 'product-card'
                , product: product
                , show_secondary_image: section.settings.show_secondary_image
                , show_vendor: section.settings.show_vendor
                , show_rating: section.settings.show_rating %}
            </div>
          {% endfor %}
        </div>
      </div>

      <!-- Trust Signals -->
      <div class="bestsellers__trust-signals">
        <div class="bestsellers__trust-item">
          <span class="bestsellers__trust-icon">üöö</span>
          <span class="bestsellers__trust-text">Free 2-Day Shipping</span>
        </div>
        <div class="bestsellers__trust-item">
          <span class="bestsellers__trust-icon">üíé</span>
          <span class="bestsellers__trust-text">Premium Quality</span>
        </div>
        <div class="bestsellers__trust-item">
          <span class="bestsellers__trust-icon">üîÑ</span>
          <span class="bestsellers__trust-text">Easy Returns</span>
        </div>
        <div class="bestsellers__trust-item">
          <span class="bestsellers__trust-icon">üõ°Ô∏è</span>
          <span class="bestsellers__trust-text">1-Year Warranty</span>
        </div>
      </div>

      {% if section.settings.show_view_all and collection.all_products_count > products_to_show %}
        <div class="bestsellers__footer text-center">
          <a href="{{ collection.url }}" class="bestsellers__cta-button">
            <span class="bestsellers__cta-text">Explore All Bestsellers</span>
            <span class="bestsellers__cta-icon">‚Üí</span>
          </a>
          <p class="bestsellers__cta-subtext">
            Join thousands of satisfied customers ‚ùÑÔ∏è
          </p>
        </div>
      {% endif %}
    {% else %}
      <div class="bestsellers__empty text-center">
        <div class="bestsellers__empty-icon">‚ùÑÔ∏è</div>
        <h3 class="bestsellers__empty-title">No bestsellers found</h3>
        <p class="bestsellers__empty-text">Create a "bestsellers" collection to display your top products here.</p>
      </div>
    {% endif %}
  </div>
</section>

{% schema %}
  {
    "name": "Bestsellers",
    "enabled_on": {
      "templates": ["index"]
    },
    "settings": [
      {
        "type": "text",
        "id": "heading",
        "label": "Heading",
        "default": "‚ùÑÔ∏è Winter Bestsellers ‚ùÑÔ∏è"
      },
      {
        "type": "textarea",
        "id": "subheading",
        "label": "Subheading",
        "default": "Discover our most-loved ice-cold essentials that customers can't get enough of"
      },
      {
        "type": "collection",
        "id": "collection",
        "label": "Collection",
        "default": "bestsellers"
      },
      {
        "type": "range",
        "id": "products_to_show",
        "min": 2,
        "max": 12,
        "step": 1,
        "default": 4,
        "label": "Products to show"
      }, {
        "type": "range",
        "id": "columns_desktop",
        "min": 1,
        "max": 5,
        "step": 1,
        "default": 4,
        "label": "Number of columns on desktop"
      }, {
        "type": "checkbox",
        "id": "show_secondary_image",
        "default": true,
        "label": "Show secondary image on hover"
      }, {
        "type": "checkbox",
        "id": "show_vendor",
        "default": false,
        "label": "Show product vendor"
      }, {
        "type": "checkbox",
        "id": "show_rating",
        "default": true,
        "label": "Show product rating"
      }, {
        "type": "checkbox",
        "id": "show_view_all",
        "default": true,
        "label": "Show 'View all' button"
      }
    ],
    "presets": [
      {
        "name": "Bestsellers"
      }
    ]
  }
{% endschema %}

<style>
  .bestsellers {
    position: relative;
    padding: 80px 0;
    background: linear-gradient(135deg, #F0F8FF 0%, #E6F3FF 30%, #B8E6FF 70%, #87CEEB 100%);
    background-size: 400% 400%;
    animation: frozen-gradient 10s ease-in-out infinite;
    overflow: hidden;
  }

  /* Background Decorations */
  .bestsellers__background {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 1;
  }

  .bestsellers__snowflakes {
    position: absolute;
    width: 100%;
    height: 100%;
  }

  .bestsellers__snowflake {
    position: absolute;
    font-size: 24px;
    opacity: 0.3;
    animation: snowfall 15s linear infinite;
  }

  .bestsellers__snowflake:nth-child(1) {
    left: 10%;
    animation-delay: 0s;
    animation-duration: 15s;
  }

  .bestsellers__snowflake:nth-child(2) {
    left: 20%;
    animation-delay: 2s;
    animation-duration: 18s;
  }

  .bestsellers__snowflake:nth-child(3) {
    left: 60%;
    animation-delay: 4s;
    animation-duration: 12s;
  }

  .bestsellers__snowflake:nth-child(4) {
    left: 80%;
    animation-delay: 6s;
    animation-duration: 16s;
  }

  .bestsellers__snowflake:nth-child(5) {
    left: 90%;
    animation-delay: 8s;
    animation-duration: 14s;
  }

  /* Header Section */
  .bestsellers__header {
    position: relative;
    z-index: 2;
    margin-bottom: 60px;
    text-align: center;
  }

  .bestsellers__title-wrapper {
    margin-bottom: 24px;
  }

  .bestsellers__title-badge {
    display: inline-block;
    background: linear-gradient(135deg, #FFD93D 0%, #FF6B6B 100%);
    color: white;
    padding: 8px 20px;
    border-radius: 25px;
    font-size: 14px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-bottom: 16px;
    box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3);
    animation: pulse-glow 2s ease-in-out infinite;
  }

  .bestsellers__title {
    font-size: 3.5rem;
    font-weight: 800;
    margin-bottom: 16px;
    line-height: 1.1;
  }

  .bestsellers__title-text {
    background: linear-gradient(135deg, #4A90E2 0%, #2171B5 30%, #87CEEB 70%, #B8E6FF 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    display: inline-block;
    animation: text-shimmer 3s ease-in-out infinite;
  }

  .bestsellers__title-decoration {
    display: block;
    font-size: 1.5rem;
    margin-top: 8px;
    animation: bounce-sparkles 2s ease-in-out infinite;
  }

  .bestsellers__subtitle {
    font-size: 1.25rem;
    color: #4A90E2;
    max-width: 600px;
    margin: 0 auto 40px;
    line-height: 1.6;
    font-weight: 500;
    text-shadow: 0 2px 4px rgba(74, 144, 226, 0.1);
  }

  /* Social Proof Stats */
  .bestsellers__stats {
    display: flex;
    justify-content: center;
    gap: 40px;
    margin-bottom: 20px;
  }

  .bestsellers__stat {
    text-align: center;
    background: rgba(255, 255, 255, 0.8);
    backdrop-filter: blur(10px);
    padding: 20px 24px;
    border-radius: 16px;
    border: 1px solid rgba(255, 255, 255, 0.3);
    box-shadow: 0 8px 25px rgba(74, 144, 226, 0.15);
    transition: transform 0.3s ease;
  }

  .bestsellers__stat:hover {
    transform: translateY(-5px);
  }

  .bestsellers__stat-number {
    font-size: 2rem;
    font-weight: 800;
    background: linear-gradient(135deg, #4A90E2 0%, #87CEEB 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    margin-bottom: 4px;
  }

  .bestsellers__stat-label {
    font-size: 12px;
    color: #666;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  /* Products Grid */
  .bestsellers__grid-wrapper {
    position: relative;
    z-index: 2;
    margin-bottom: 50px;
  }

  .bestsellers__grid {
    gap: 30px;
  }

  .bestsellers__item {
    opacity: 0;
    transform: translateY(30px);
    animation: fadeInUp 0.6s ease forwards;
  }

  /* Trust Signals */
  .bestsellers__trust-signals {
    display: flex;
    justify-content: center;
    gap: 32px;
    margin: 50px 0;
    flex-wrap: wrap;
  }

  .bestsellers__trust-item {
    display: flex;
    align-items: center;
    gap: 8px;
    background: rgba(255, 255, 255, 0.9);
    backdrop-filter: blur(10px);
    padding: 12px 20px;
    border-radius: 20px;
    border: 1px solid rgba(255, 255, 255, 0.3);
    box-shadow: 0 4px 15px rgba(74, 144, 226, 0.1);
    transition: all 0.3s ease;
  }

  .bestsellers__trust-item:hover {
    transform: translateY(-3px);
    box-shadow: 0 8px 25px rgba(74, 144, 226, 0.2);
  }

  .bestsellers__trust-icon {
    font-size: 18px;
  }

  .bestsellers__trust-text {
    font-size: 14px;
    font-weight: 600;
    color: #222;
  }

  /* Footer CTA */
  .bestsellers__footer {
    position: relative;
    z-index: 2;
    margin-top: 60px;
  }

  .bestsellers__cta-button {
    display: inline-flex;
    align-items: center;
    gap: 12px;
    background: linear-gradient(135deg, #4A90E2 0%, #2171B5 100%);
    color: white;
    padding: 18px 36px;
    border-radius: 16px;
    text-decoration: none;
    font-weight: 600;
    font-size: 1.125rem;
    box-shadow: 0 8px 25px rgba(74, 144, 226, 0.3);
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
  }

  .bestsellers__cta-button::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
    transition: left 0.5s ease;
  }

  .bestsellers__cta-button:hover {
    transform: translateY(-3px);
    box-shadow: 0 12px 35px rgba(74, 144, 226, 0.4);
    background: linear-gradient(135deg, #2171B5 0%, #4A90E2 100%);
  }

  .bestsellers__cta-button:hover::before {
    left: 100%;
  }

  .bestsellers__cta-icon {
    font-size: 18px;
    transition: transform 0.3s ease;
  }

  .bestsellers__cta-button:hover .bestsellers__cta-icon {
    transform: translateX(5px);
  }

  .bestsellers__cta-subtext {
    margin-top: 12px;
    font-size: 14px;
    color: #4A90E2;
    font-weight: 500;
  }

  /* Empty State */
  .bestsellers__empty {
    text-align: center;
    padding: 60px 20px;
    background: rgba(255, 255, 255, 0.8);
    backdrop-filter: blur(10px);
    border-radius: 20px;
    border: 1px solid rgba(255, 255, 255, 0.3);
    box-shadow: 0 8px 25px rgba(74, 144, 226, 0.15);
    max-width: 500px;
    margin: 0 auto;
  }

  .bestsellers__empty-icon {
    font-size: 48px;
    margin-bottom: 16px;
    animation: float-sparkles 3s ease-in-out infinite;
  }

  .bestsellers__empty-title {
    font-size: 1.5rem;
    font-weight: 700;
    color: #222;
    margin-bottom: 8px;
  }

  .bestsellers__empty-text {
    color: #666;
    font-size: 16px;
    line-height: 1.5;
  }

  /* Animations */
  @keyframes frozen-gradient {
    0,
    100% {
      background-position: 0 50%;
    }
    50% {
      background-position: 100% 50%;
    }
  }

  @keyframes snowfall {
    0% {
      transform: translateY(-100vh) rotate(0deg);
      opacity: 0.3;
    }
    10% {
      opacity: 0.6;
    }
    90% {
      opacity: 0.3;
    }
    100% {
      transform: translateY(100vh) rotate(360deg);
      opacity: 0;
    }
  }

  @keyframes text-shimmer {
    0,
    100% {
      filter: brightness(1);
    }
    50% {
      filter: brightness(1.2);
    }
  }

  @keyframes bounce-sparkles {
    0,
    100% {
      transform: scale(1);
    }
    50% {
      transform: scale(1.1);
    }
  }

  @keyframes pulse-glow {
    0,
    100% {
      box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3);
    }
    50% {
      box-shadow: 0 8px 25px rgba(255, 107, 107, 0.5);
    }
  }

  @keyframes fadeInUp {
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes float-sparkles {
    0,
    100% {
      transform: translateY(0px);
    }
    50% {
      transform: translateY(-10px);
    }
  }

  /* Responsive Design */
  @media (max-width: 1024px) {
    .bestsellers__stats {
      gap: 24px;
    }

    .bestsellers__trust-signals {
      gap: 20px;
    }
  }

  @media (max-width: 768px) {
    .bestsellers {
      padding: 60px 0;
    }

    .bestsellers__header {
      margin-bottom: 40px;
    }

    .bestsellers__title {
      font-size: 2.5rem;
    }

    .bestsellers__subtitle {
      font-size: 1.125rem;
    }

    .bestsellers__stats {
      flex-direction: column;
      align-items: center;
      gap: 16px;
    }

    .bestsellers__stat {
      width: 100%;
      max-width: 200px;
    }

    .bestsellers__trust-signals {
      flex-direction: column;
      align-items: center;
      gap: 16px;
    }

    .bestsellers__trust-item {
      width: 100%;
      max-width: 250px;
      justify-content: center;
    }

    .bestsellers__grid {
      gap: 20px;
    }
  }

  @media (max-width: 480px) {
    .bestsellers {
      padding: 40px 0;
    }

    .bestsellers__title {
      font-size: 2rem;
    }

    .bestsellers__title-decoration {
      font-size: 1.25rem;
    }

    .bestsellers__subtitle {
      font-size: 1rem;
    }

    .bestsellers__stat-number {
      font-size: 1.5rem;
    }

    .bestsellers__cta-button {
      padding: 16px 28px;
      font-size: 1rem;
    }

    .bestsellers__snowflakes {
      display: none;
      /* Hide snowflakes on very small screens for performance */
    }
  }
</style>